{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AIConditionalAutonomyAction",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "action_id",
    "description",
    "trigger_conditions",
    "preconditions",
    "allowed_scope",
    "max_frequency",
    "blast_radius",
    "rollback_procedure_ref",
    "required_human_confirmation",
    "audit_level"
  ],
  "properties": {
    "apiVersion": {"type": "string"},
    "kind": {"type": "string"},
    "action_id": {"type": "string", "minLength": 1},
    "description": {"type": "string", "minLength": 1},
    "trigger_conditions": {
      "type": "array",
      "minItems": 1,
      "items": {"type": "string", "minLength": 1}
    },
    "preconditions": {
      "type": "array",
      "minItems": 1,
      "items": {"type": "string", "minLength": 1}
    },
    "allowed_scope": {
      "type": "object",
      "additionalProperties": false,
      "required": ["tenants", "workloads", "providers"],
      "properties": {
        "tenants": {
          "type": "array",
          "minItems": 1,
          "items": {"type": "string", "minLength": 1}
        },
        "workloads": {
          "type": "array",
          "minItems": 1,
          "items": {"type": "string", "minLength": 1}
        },
        "providers": {
          "type": "array",
          "minItems": 1,
          "items": {"type": "string", "minLength": 1}
        }
      }
    },
    "max_frequency": {
      "type": "object",
      "additionalProperties": false,
      "required": ["max_per_interval", "interval"],
      "properties": {
        "max_per_interval": {"type": "integer", "minimum": 1},
        "interval": {"enum": ["hour", "day", "week"]}
      }
    },
    "blast_radius": {
      "enum": ["single_workload", "single_service", "single_tenant"]
    },
    "rollback_procedure_ref": {"type": "string", "minLength": 1},
    "required_human_confirmation": {"type": "boolean"},
    "audit_level": {"enum": ["full"]}
  }
}
